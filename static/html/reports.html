<!DOCTYPE html>
<html lang="en">

<head>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Tellet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" src="{{url_for('static', path='js/tellet.js')}}"></script>
  <!-- <script type="text/javascript" src="{{url_for('static', path='js/reports.js')}}"></script> -->
</head>

<body>
  <div class="container">

    {{reports | safe}}
    <a id="addother" href="/" class="btn btn-danger btn-lg" role="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-clipboard-plus"
        viewBox="0 0 16 16">
        <path fill-rule="evenodd"
          d="M8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z" />
        <path
          d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" />
        <path
          d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" />
      </svg>
      <br />Autre</a>
    <a id="logout" href="/"><button type="button" class="btn btn-warning ribbon">Retour</button></a>

  </div>
  <!-- Modal window: Adding item to report list  -->
  <div id="addModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="tasktitle" class="modal-title"></h5>
          <button type="button" class="close" data-bs-dismiss="modal">&times;</button>

        </div>
        <div class="modal-body">
          <p>
          <div class="form-group">
            <label for="realizedTask">TÃ¢che rÃ©alisÃ©e</label>
            <input id="realizedTask" input class="form-control" list="whatyoudid" name="what"
              placeholder="TÃ¢che rÃ©alisÃ©e">
          </div>
          </p>
          <p>
          <div id="mood" class="btn-group" role="group" aria-label="Mood">
            <input type="radio" data-value=0 class="btn-check" name="btnradio1" id="moodok" autocomplete="off" checked>
            <label class="btn btn-outline-success" for="moodok">ðŸ˜ƒ</label>
            <input type="radio" data-value=1 class="btn-check" name="btnradio1" id="moodtired" autocomplete="off">
            <label class="btn btn-outline-secondary" for="moodtired">ðŸ˜«</label>
            <input type="radio" data-value=2 class="btn-check" name="btnradio1" id="moodnotok" autocomplete="off">
            <label class="btn btn-outline-danger" for="moodnotok">ðŸ˜ </label>

          </div>
          </p>
          <p>
          <div id="duration" class="btn-group" role="group" aria-label="Task duration">
            <input type="radio" data-value=0 class="btn-check" name="btnradio2" id="btnradio1" autocomplete="off"
              checked>
            <label class="btn btn-outline-primary" for="btnradio1">&lt;1 min</label>
            <input type="radio" data-value=1 class="btn-check" name="btnradio2" id="btnradio2" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnradio2">1-7 min</label>
            <input type="radio" data-value=2 class="btn-check" name="btnradio2" id="btnradio3" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnradio3">10-15 min</label>
            <input type="radio" data-value=3 class="btn-check" name="btnradio2" id="btnradio4" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnradio4">&gt;20-30 min</label>
            <input type="radio" data-value=4 class="btn-check" name="btnradio2" id="btnradio5" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnradio5">&gt;30 min</label>
            <input type="radio" data-value=5 class="btn-check" name="btnradio2" id="btnradio6" autocomplete="off">
            <label class="btn btn-outline-primary" for="btnradio6">&gt;2 h</label>
          </div>
          </p>

          <div class="form-group">
            <label for="taskComments">Commentaires</label>
            <textarea class="form-control" id="taskComments" rows="3"></textarea>
          </div>
          <div class="modal-footer">
            <button id="addtoreport" type="button" class="btn btn-success" data-bs-dismiss="modal">Save</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const headers = {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    }

    function collect_answers() {
      comments = $("textarea#taskComments").val();
      comments = comments.replace(/;/g, "-");
      taskduration = $('#duration input:radio:checked').attr('data-value');
      taskmood = $('#mood input:radio:checked').attr('data-value');
      what += ";" + taskmood + ";" + taskduration + ";" + comments;
      console.log(`Answers: ${what}`);
      return what;
    }

    function add() {
      if ($("input#realizedTask").val() == '') {
        alert('Please set a correct value.');
        return
      }

      data = { what: collect_answers(), where: "reports" }

      options = {
        headers: headers,
        method: "POST",
        body: JSON.stringify(data)
      }

      fetch('/add', options).then(res => res.json()).then(function (res) {
        console.log(res)
        return true;
      })
    }

    $("a").click(function (e) {
      id = $(this).attr('id');
      e.preventDefault();

      /* Clicking on the big Add button */
      if (id == "addother") {
        $('#addModal').modal('show');
        $("input#realizedTask").val("");
        $("textarea#taskComments").val("");
        $("input#realizedTask").parent().show();
        $("h5#tasktitle").text("");
      }
    })

    $('a#logout').unbind('click')

    /* Adding to the report list */
    $('button#addtoreport').click(add);

    $("img").click(function (e) {
      id = $(this).attr('id');
      val = $(this).attr('data-value');
      desc = $(this).attr('data-description');

      $('#addModal').modal('show');
      $("textarea#taskComments").val("");
      $("input#realizedTask").val(val);
      $("input#realizedTask").parent().hide();
      $("h5#tasktitle").text(desc);

    });
  </script>
</body>

</html>